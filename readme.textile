h1. yerform

is a PHP class to create forms, handle validation and sending.

Building forms can be horrible, they are allways different and webdesigners are talented in making it nearly impossible. This piece of code tries to put the beast in a cage.

This documentation is incomplete and corrupting changes still may ahead!

h2. Roadmap

* basic css styling, focusing on layoutoptions
* definable dateformat for date validation
* config swift (PHP Mail, Sendmail, Smtp & SSL)
* complete documentation
* captcha

* [done] prepared for using with ajax
* [done] output type return and echo
* [done] field radio
* [done] validation for email
* [done] initial release

Just ask me for your needs at mail@johannheyne.de or create a new issue.

h2. Setup

h3. The yerForm Class

Autoload the "core/yerform.php". The class will only be loaded if it is needed.
<pre><code>function __autoload( $class_name ) {
    if ( $class_name == 'yerForm' ) require_once( 'yerform/core/yerform.php');
}
</code></pre>

h3. The yerForm Styles

Include the styles from a theme if the yerForm class exists.
<pre><code>if ( class_exists('yerForm') ) {
    echo '<link rel="stylesheet" type="text/css" href="yerform/themes/default/yerform-styles.css" />';
}
</code></pre>

h3. Create a New Form

<pre><code>$form = new yerForm();
$form->form_id = 'my_contact_form';
</code></pre>

h3. Configuration

<pre><code>$form->config( array(
    'form_class' => false,
    'action' => false,
    'sent_page' => false,
    'honeypot' => 'Honeypot',
    'mail_subject' => 'Contact',
    'field_sender_mail' => 'email',
    'fields_sender_name' => array( 'surename', 'familyname' ),
    'recipient_mail' => 'my email',
    'recipient_name' => 'my name',
    'mail_text' => "
        Contactform
        Name: {surename} {familyname}
        E-Mail: {email}
        Message:
        {message}
    ",
    'message_error_main' => array(
        'typ'=>'error',
        'text'=>'Could not send form! Check the following fields: {fields}'
    ),
    'message_mail_sending' => array(
        'typ'=>'info',
        'text'=>'Is sending!'
    ),
    'message_mail_sent' => array(
        'typ'=>'info',
        'text'=>'Sent!'
    )
));
</code></pre>

*sent_page*
<em>(string)</em> URL to redirect, after a form was sent.
The <em>default</em> is false.

h2. Global messages

This is for all global messages like validation and send status.

<pre><code>$form->set( 'messages' );
</code></pre>

h2. Building the form structure

The basic structure are fieldsets. Inside a fieldset belongs a list. Inside a list belongs fields. A field represents a single list-item. But you can use groups for nesting the list.

<pre><code>$form->set( 'fieldset_begin', array(
    'legend'=>'Contactdata',
    'class'=>false,
    'require_info'=>'*required'
));
    $form->set( 'list_begin' );
        /* a field */
        /* or a field group */
        $form->set( 'group_begin', array(
            'label' => 'Groupname',
            'layout' => 'table'
        ));
        /* some fields */
        $form->set( 'group_end');
    $form->set( 'list_end' );
$form->set( 'fieldset_end' );
</code></pre>

h2. The fields

h3. Text

<pre><code>$form->set( 'field_text', array(
    'name' => 'no name',
    'array' => false,
    'label' => 'no name',
    'placeholder' => false,
    'sufix' => '',
    'value' => '',
    'size' => '40',
    'maxlength' => '200',
    'layout' => false,
    'padding' => array( 0, 0 ),
    'class' => false
));
</code></pre>

*name*
<em>(string)</em> The name and Id of the field.

*array*
<em>(integer)</em> For fields with same name like a checkboxset.

*label*
<em>(string)</em> The label of the field.

*placeholder*
<em>(string)</em> Defines a placeholder text for the field.

*sufix*
<em>(string)</em> Displaying after the Field.

*value*
<em>(string)</em> Defines a value prefilled.

*size*
<em>(integer)</em> Defines the size of the textfield. 
The <em>default</em> is $form->field_text_size = 40.

*maxlength*
<em>(integer)</em> Defines the maximal lenght of the textfields content. 
The <em>default</em> is $form->field_text_maxlength = 200.

*layout*
<em>(false | string)</em> Defines the orientation in the layout. Can be false or 'horizontal'.

*padding*
<em>(array( integer-left, integer-right ))</em> Defines the left and right padding of the field list-item. 
This is usefull for giving horizontal orientated fields some spacing.

*class*
<em>(string)</em> Defines a class on the field list-item.

h3. Textarea

<pre><code>$form->set( 'field_textarea', array(
    'name' => 'noname',
    'array' => false,
    'label' => 'no name',
    'value' => '',
    'cols' => $this->field_textarea_cols,
    'rows' => $this->field_textarea_rows,
    'padding' => array(0,0),
    'layout' => false
));
</code></pre>

h3. Checkbox

<pre><code>$form->set( 'field_checkbox', array(
    'name' => 'noname',
    'array' => false,
    'label' => 'no name',
    'data' => 'checked'
));
</code></pre>

h3. Radio

<pre><code>$form->set( 'field_radio', array(
    'name' => 'noname',
    'array' => false,
    'label' => 'no name',
    'data' => 'checked'
));
</code></pre>

h3. Select

<pre><code>$form->set( 'field_select', array(
    'name' => 'noname',
    'array' => false,
    'label' => 'no name',
    'data' => array(
        '' => 'wähle…'
    )
));
</code></pre>

h3. Hidden

<pre><code>$form->set( 'field_hidden', array(
    'name' => 'noname',
    'value' => ''
));
</code></pre>

h2. Validation

Just a sample, where to place the validation array:

<pre><code>$form->set( 'field_text', array(
    'name' => 'surename',
    'label' => 'Surename',
    'layout' => 'table',
    'validation' => array(
        0 => array(
            'type' => 'required',
            'cond' => true,
            'message' => $messages['required']
        )
    )
));</code></pre>

Just put the messages for each validation error type in a variable as an array like this:
$messages['required'];

h3. Required

<pre><code>array(
    'type' => 'required',
    'cond' => true,
    'message' => $messages['required']
)
</code></pre>

h3. E-Mail

<pre><code>array(
    'type' => 'email',
    'message' => $messages['email']
)
</code></pre>

h3. Date

<pre><code>array(
    'type' => 'date',
    'min' => '+1 day',
    'max' => '+2 year',
    'dependency' => array(
        'field' => 'fieldname',
        'value' => '+1 day',
        'operator' => '>=',
        'message' => $messages['date-dependency']
    ),
    'message-checkdate' => $messages['checkdate'],
    'message-dateformat' => $messages['dateformat'],
    'message-min-max' => $messages['date-min-max']
)
</code></pre>

*min max*
<em>(You can use the same date definitions as for strtotime())</em> Defines the minimum and maximum of the date.
For example:
'now'
'05-07-2012'
'05-07-2012 -1 day'
'10 September 2000'
'+1 day'
'+1 week'
'-1 year +2 days'
'next Thursday'
'last Monday'

*dependency*
Depending the value with the value of another date-field.

*checkdate*
If a date not exists for example 32.13.2012

*message-dateformat*
If the date does not fit the format "dd.mm.yy"
The date format will be changeable in futur.

*message-min-max*
If the date does not fit the given range of min and/or max.

h2. Output the form

<pre><code>$form->run( array(
    'output' => 'return'
));
</code></pre>

*output*
<em>('echo' | 'return')</em> Defines the type of output.

h2. Submit and Reset Button

<pre><code>$form->set( 'form_buttons', array(
    'submit' => true,
    'submit_label' => 'Submit',
    'submit_class' => false,
    'submit_btn_class' => false,
    'reset' => true,
    'reset_label' => 'Reset',
    'reset_class' => false,
    'reset_btn_class' => false
));
</code></pre>

*submit*
<em>(false | true)</em> Enables the submit-button.

*submit_label*
<em>(string)</em> Defines the buttontext.

*submit_class*
<em>(false | string)</em> Defines the class of the submit-button container.

*submit_btn_class*
<em>(false | string)</em> Defines the class of the submit-button itself.

*reset*
<em>(false | true)</em> Enables the reset-button.

*reset_label*
<em>(string)</em> Defines the buttontext.

*reset_class*
<em>(false | string)</em> Defines the class of the reset-button container.

*reset_btn_class*
<em>(false | string)</em> Defines the class of the reset-button itself.

h2. Ajax

yerform is using a html redirect after sending the form to prevent resending the form by pagereload. This wont work, if the form is part of an ajax request. You can prevent this by adding the parameter ajax=y to the action url.

<pre><code>jQuery('body').find('.formwrap form').submit( function(event) {
    event.preventDefault();

    var form = jQuery(this),
    url = form.attr('action');

    jQuery.post( url + '?ajax=y', form.serialize(), function( data ) {

        jQuery('.formwrap').html( data );

    });
});
</code></pre>